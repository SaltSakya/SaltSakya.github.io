<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.62" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://saltsakya.github.io/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html"><meta property="og:site_name" content="舒服家"><meta property="og:title" content="属性、命令和函数"><meta property="og:description" content="3.1 顶点/片元着色器的结构 为了分析它的结构，我们要创建一个 Unlit 着色器并命名为“USB_simple_color”。 我们已经了解到，这种着色器是基础颜色模型，并且代码中没有过多的优化，这让我们可以深入分析其各种属性及方法。 当我们第一次创建材质时，Unity 会添加默认代码方便其编译过程。 在程序中，我们可以看见以这种 GPU 可以解释..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2023-06-24T18:53:14.000Z"><meta property="article:author" content="舒服嘉"><meta property="article:tag" content="shader"><meta property="article:tag" content="Unity"><meta property="article:tag" content="CG"><meta property="article:published_time" content="2022-06-11T00:00:00.000Z"><meta property="article:modified_time" content="2023-06-24T18:53:14.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"属性、命令和函数","image":[""],"datePublished":"2022-06-11T00:00:00.000Z","dateModified":"2023-06-24T18:53:14.000Z","author":[{"@type":"Person","name":"舒服嘉","url":"https://saltsakya.github.io","email":"SaltSakya@Yahoo.com"}]}</script><title>属性、命令和函数 | 舒服家</title><meta name="description" content="3.1 顶点/片元着色器的结构 为了分析它的结构，我们要创建一个 Unlit 着色器并命名为“USB_simple_color”。 我们已经了解到，这种着色器是基础颜色模型，并且代码中没有过多的优化，这让我们可以深入分析其各种属性及方法。 当我们第一次创建材质时，Unity 会添加默认代码方便其编译过程。 在程序中，我们可以看见以这种 GPU 可以解释...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-e0a115fd.css" as="style"><link rel="stylesheet" href="/assets/style-e0a115fd.css">
    <link rel="modulepreload" href="/assets/app-2685e7e5.js"><link rel="modulepreload" href="/assets/properties_commands_and_functions.html-61a1459c.js"><link rel="modulepreload" href="/assets/properties_commands_and_functions.html-87d2c652.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-c27b6911.js"><link rel="prefetch" href="/assets/intro.html-3622452a.js" as="script"><link rel="prefetch" href="/assets/index.html-610c481f.js" as="script"><link rel="prefetch" href="/assets/slides.html-540e1ffc.js" as="script"><link rel="prefetch" href="/assets/intro.html-4f1b1f5d.js" as="script"><link rel="prefetch" href="/assets/index.html-6f275afb.js" as="script"><link rel="prefetch" href="/assets/slides.html-07b849d3.js" as="script"><link rel="prefetch" href="/assets/disable.html-01ed3b5b.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-104f3c99.js" as="script"><link rel="prefetch" href="/assets/markdown.html-5846743f.js" as="script"><link rel="prefetch" href="/assets/page.html-90b75936.js" as="script"><link rel="prefetch" href="/assets/index.html-7bf28456.js" as="script"><link rel="prefetch" href="/assets/index.html-bb9363fa.js" as="script"><link rel="prefetch" href="/assets/template.html-83a9812d.js" as="script"><link rel="prefetch" href="/assets/disable.html-ed71bffd.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-f8bb808f.js" as="script"><link rel="prefetch" href="/assets/markdown.html-f07a726b.js" as="script"><link rel="prefetch" href="/assets/page.html-66be21f3.js" as="script"><link rel="prefetch" href="/assets/index.html-ed0813ea.js" as="script"><link rel="prefetch" href="/assets/ArknightsDrawAgent.html-3f749af6.js" as="script"><link rel="prefetch" href="/assets/propagating_velocities_through_animation_systems.html-326e20b6.js" as="script"><link rel="prefetch" href="/assets/Requirements.html-23fcb88d.js" as="script"><link rel="prefetch" href="/assets/Yabot.html-e566aac0.js" as="script"><link rel="prefetch" href="/assets/index.html-405c87e6.js" as="script"><link rel="prefetch" href="/assets/NavMap.html-86fd7837.js" as="script"><link rel="prefetch" href="/assets/index.html-f4489c6c.js" as="script"><link rel="prefetch" href="/assets/SurfaceSample.html-1d9f7776.js" as="script"><link rel="prefetch" href="/assets/index.html-66dde7ea.js" as="script"><link rel="prefetch" href="/assets/chronicles.html-921b61c7.js" as="script"><link rel="prefetch" href="/assets/index.html-85108ca8.js" as="script"><link rel="prefetch" href="/assets/idx.html-b723bd03.js" as="script"><link rel="prefetch" href="/assets/index.html-d33878e1.js" as="script"><link rel="prefetch" href="/assets/implementation_and_other_concepts.html-68cf81a7.js" as="script"><link rel="prefetch" href="/assets/initial_observations.html-ab10e278.js" as="script"><link rel="prefetch" href="/assets/index.html-0969cb2f.js" as="script"><link rel="prefetch" href="/assets/shader_in_unity.html-491ffb5f.js" as="script"><link rel="prefetch" href="/assets/advanced_concepts.html-f6440251.js" as="script"><link rel="prefetch" href="/assets/ray_tracing.html-dffc2d44.js" as="script"><link rel="prefetch" href="/assets/index.html-82391f13.js" as="script"><link rel="prefetch" href="/assets/sphere_tracing.html-33edfad6.js" as="script"><link rel="prefetch" href="/assets/introduction_to_the_chapter.html-eb31fb00.js" as="script"><link rel="prefetch" href="/assets/lighting.html-1d367b23.js" as="script"><link rel="prefetch" href="/assets/index.html-9a069e8d.js" as="script"><link rel="prefetch" href="/assets/shader_graph.html-aece92d6.js" as="script"><link rel="prefetch" href="/assets/shadow.html-c6f9ab8b.js" as="script"><link rel="prefetch" href="/assets/surface.html-9dc846d4.js" as="script"><link rel="prefetch" href="/assets/404.html-123d36db.js" as="script"><link rel="prefetch" href="/assets/index.html-34b649fc.js" as="script"><link rel="prefetch" href="/assets/index.html-ee3c9483.js" as="script"><link rel="prefetch" href="/assets/index.html-81da80ff.js" as="script"><link rel="prefetch" href="/assets/index.html-7caeea65.js" as="script"><link rel="prefetch" href="/assets/index.html-443105e2.js" as="script"><link rel="prefetch" href="/assets/index.html-55c4351e.js" as="script"><link rel="prefetch" href="/assets/index.html-34f4d1b8.js" as="script"><link rel="prefetch" href="/assets/index.html-6d985195.js" as="script"><link rel="prefetch" href="/assets/index.html-7fd27a79.js" as="script"><link rel="prefetch" href="/assets/index.html-528e3dd7.js" as="script"><link rel="prefetch" href="/assets/index.html-da173147.js" as="script"><link rel="prefetch" href="/assets/index.html-edd797d7.js" as="script"><link rel="prefetch" href="/assets/index.html-3b68a003.js" as="script"><link rel="prefetch" href="/assets/index.html-abb49144.js" as="script"><link rel="prefetch" href="/assets/index.html-f19ba084.js" as="script"><link rel="prefetch" href="/assets/index.html-5d81e4ce.js" as="script"><link rel="prefetch" href="/assets/index.html-66c3bd08.js" as="script"><link rel="prefetch" href="/assets/index.html-5e5171b2.js" as="script"><link rel="prefetch" href="/assets/index.html-d295e16c.js" as="script"><link rel="prefetch" href="/assets/index.html-3014281b.js" as="script"><link rel="prefetch" href="/assets/index.html-705bf87e.js" as="script"><link rel="prefetch" href="/assets/index.html-9d1cc178.js" as="script"><link rel="prefetch" href="/assets/index.html-f955f9ca.js" as="script"><link rel="prefetch" href="/assets/index.html-5a236881.js" as="script"><link rel="prefetch" href="/assets/index.html-f2a26d08.js" as="script"><link rel="prefetch" href="/assets/index.html-60f0f4ef.js" as="script"><link rel="prefetch" href="/assets/index.html-9ed5fbbb.js" as="script"><link rel="prefetch" href="/assets/index.html-7b33d89f.js" as="script"><link rel="prefetch" href="/assets/index.html-5cf77a36.js" as="script"><link rel="prefetch" href="/assets/index.html-121b9b73.js" as="script"><link rel="prefetch" href="/assets/index.html-71b9889a.js" as="script"><link rel="prefetch" href="/assets/index.html-bc485ba1.js" as="script"><link rel="prefetch" href="/assets/index.html-d356c8f5.js" as="script"><link rel="prefetch" href="/assets/index.html-a4af0d45.js" as="script"><link rel="prefetch" href="/assets/intro.html-6efab11b.js" as="script"><link rel="prefetch" href="/assets/index.html-a88f8036.js" as="script"><link rel="prefetch" href="/assets/slides.html-c71ab94f.js" as="script"><link rel="prefetch" href="/assets/intro.html-057bb7d1.js" as="script"><link rel="prefetch" href="/assets/index.html-07938da4.js" as="script"><link rel="prefetch" href="/assets/slides.html-61b15028.js" as="script"><link rel="prefetch" href="/assets/disable.html-ba97dd56.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-dab766bc.js" as="script"><link rel="prefetch" href="/assets/markdown.html-b43a019b.js" as="script"><link rel="prefetch" href="/assets/page.html-4288c474.js" as="script"><link rel="prefetch" href="/assets/index.html-447d9c56.js" as="script"><link rel="prefetch" href="/assets/index.html-4af34c2e.js" as="script"><link rel="prefetch" href="/assets/template.html-0516a4bd.js" as="script"><link rel="prefetch" href="/assets/disable.html-6c70df2f.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-43b1bc3b.js" as="script"><link rel="prefetch" href="/assets/markdown.html-74c6f0ad.js" as="script"><link rel="prefetch" href="/assets/page.html-b37774ef.js" as="script"><link rel="prefetch" href="/assets/index.html-b814b0e0.js" as="script"><link rel="prefetch" href="/assets/ArknightsDrawAgent.html-cd30087e.js" as="script"><link rel="prefetch" href="/assets/propagating_velocities_through_animation_systems.html-dc175af5.js" as="script"><link rel="prefetch" href="/assets/Requirements.html-3c74e2ba.js" as="script"><link rel="prefetch" href="/assets/Yabot.html-66262fd1.js" as="script"><link rel="prefetch" href="/assets/index.html-2a29e6ef.js" as="script"><link rel="prefetch" href="/assets/NavMap.html-8b02d062.js" as="script"><link rel="prefetch" href="/assets/index.html-1b8d138b.js" as="script"><link rel="prefetch" href="/assets/SurfaceSample.html-82f49ba4.js" as="script"><link rel="prefetch" href="/assets/index.html-96974975.js" as="script"><link rel="prefetch" href="/assets/chronicles.html-8bf17216.js" as="script"><link rel="prefetch" href="/assets/index.html-21017cf3.js" as="script"><link rel="prefetch" href="/assets/idx.html-fc87da11.js" as="script"><link rel="prefetch" href="/assets/index.html-e94feb60.js" as="script"><link rel="prefetch" href="/assets/implementation_and_other_concepts.html-2030df2a.js" as="script"><link rel="prefetch" href="/assets/initial_observations.html-a771075a.js" as="script"><link rel="prefetch" href="/assets/index.html-8d61542a.js" as="script"><link rel="prefetch" href="/assets/shader_in_unity.html-987c58a3.js" as="script"><link rel="prefetch" href="/assets/advanced_concepts.html-19b6f348.js" as="script"><link rel="prefetch" href="/assets/ray_tracing.html-d77a31cb.js" as="script"><link rel="prefetch" href="/assets/index.html-f745427f.js" as="script"><link rel="prefetch" href="/assets/sphere_tracing.html-b8e0bb94.js" as="script"><link rel="prefetch" href="/assets/introduction_to_the_chapter.html-7165a54e.js" as="script"><link rel="prefetch" href="/assets/lighting.html-cedfd17c.js" as="script"><link rel="prefetch" href="/assets/index.html-d42715f0.js" as="script"><link rel="prefetch" href="/assets/shader_graph.html-9c59d34e.js" as="script"><link rel="prefetch" href="/assets/shadow.html-27c0e089.js" as="script"><link rel="prefetch" href="/assets/surface.html-b5137c8e.js" as="script"><link rel="prefetch" href="/assets/404.html-3e0de44e.js" as="script"><link rel="prefetch" href="/assets/index.html-4bb74ddc.js" as="script"><link rel="prefetch" href="/assets/index.html-e456fab1.js" as="script"><link rel="prefetch" href="/assets/index.html-5e956453.js" as="script"><link rel="prefetch" href="/assets/index.html-6c54fd9a.js" as="script"><link rel="prefetch" href="/assets/index.html-c07fb0fb.js" as="script"><link rel="prefetch" href="/assets/index.html-559d3b08.js" as="script"><link rel="prefetch" href="/assets/index.html-a1ec8d94.js" as="script"><link rel="prefetch" href="/assets/index.html-684cb782.js" as="script"><link rel="prefetch" href="/assets/index.html-ea6c05b7.js" as="script"><link rel="prefetch" href="/assets/index.html-7e3e2981.js" as="script"><link rel="prefetch" href="/assets/index.html-18b45982.js" as="script"><link rel="prefetch" href="/assets/index.html-e8a49d2e.js" as="script"><link rel="prefetch" href="/assets/index.html-6c2b5d96.js" as="script"><link rel="prefetch" href="/assets/index.html-c1c47a81.js" as="script"><link rel="prefetch" href="/assets/index.html-7dd31ef6.js" as="script"><link rel="prefetch" href="/assets/index.html-35b1420a.js" as="script"><link rel="prefetch" href="/assets/index.html-f841c2eb.js" as="script"><link rel="prefetch" href="/assets/index.html-692846cc.js" as="script"><link rel="prefetch" href="/assets/index.html-6a55e56f.js" as="script"><link rel="prefetch" href="/assets/index.html-e0ca7c07.js" as="script"><link rel="prefetch" href="/assets/index.html-d392a77e.js" as="script"><link rel="prefetch" href="/assets/index.html-d3b70843.js" as="script"><link rel="prefetch" href="/assets/index.html-b192b7fb.js" as="script"><link rel="prefetch" href="/assets/index.html-23b0a958.js" as="script"><link rel="prefetch" href="/assets/index.html-d28db3b8.js" as="script"><link rel="prefetch" href="/assets/index.html-22a3cd7c.js" as="script"><link rel="prefetch" href="/assets/index.html-c51f7998.js" as="script"><link rel="prefetch" href="/assets/index.html-3a37ecfd.js" as="script"><link rel="prefetch" href="/assets/index.html-b14170d6.js" as="script"><link rel="prefetch" href="/assets/index.html-e4214578.js" as="script"><link rel="prefetch" href="/assets/index.html-47b4858e.js" as="script"><link rel="prefetch" href="/assets/index.html-20cf4c16.js" as="script"><link rel="prefetch" href="/assets/index.html-ac1274af.js" as="script"><link rel="prefetch" href="/assets/index.html-4d70fd0a.js" as="script"><link rel="prefetch" href="/assets/dash.all.min-0a2d855f.js" as="script"><link rel="prefetch" href="/assets/mpegts-d8e77270.js" as="script"><link rel="prefetch" href="/assets/hls.min-e7a97777.js" as="script"><link rel="prefetch" href="/assets/artplayer-0687ddfd.js" as="script"><link rel="prefetch" href="/assets/giscus-52604b1e.js" as="script"><link rel="prefetch" href="/assets/auto-fa8841cf.js" as="script"><link rel="prefetch" href="/assets/index-ae8c1e74.js" as="script"><link rel="prefetch" href="/assets/flowchart-d65a1d8e.js" as="script"><link rel="prefetch" href="/assets/mermaid.core-51f39901.js" as="script"><link rel="prefetch" href="/assets/highlight.esm-75b11b9d.js" as="script"><link rel="prefetch" href="/assets/markdown.esm-0191f9da.js" as="script"><link rel="prefetch" href="/assets/math.esm-70a288c8.js" as="script"><link rel="prefetch" href="/assets/notes.esm-a106bb2c.js" as="script"><link rel="prefetch" href="/assets/reveal.esm-ec5549c1.js" as="script"><link rel="prefetch" href="/assets/search.esm-7e6792e2.js" as="script"><link rel="prefetch" href="/assets/zoom.esm-b83b91d0.js" as="script"><link rel="prefetch" href="/assets/VuePlayground-acea3553.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-2450701e.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button type="button" class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a href="/" class="brand"><img class="logo" src="/logo.svg" alt="舒服家"><!----><span class="site-name hide-in-pad">舒服家</span></a><!--]--><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><!--[--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="主页"><span class="font-icon icon iconfont icon-home" style=""></span>主页<!----></a></div><div class="nav-item hide-in-mobile"><a href="/demo/" class="nav-link" aria-label="演示"><span class="font-icon icon iconfont icon-discover" style=""></span>演示<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="游戏开发"><span class="title"><span class="font-icon icon iconfont icon-game" style=""></span>游戏开发</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>基础</span></h4><ul class="dropdown-subitem-wrapper"></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>高级</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/game_dev/advance/NavMap.html" class="nav-link" aria-label="地图框架"><span class="font-icon icon iconfont icon-sitemap" style=""></span>地图框架<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>TA</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/game_dev/TA/the_unity_shader_bible" class="nav-link active" aria-label="Unity 着色器圣经"><span class="font-icon icon iconfont icon-repo" style=""></span>Unity 着色器圣经<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="其他"><span class="title"><span class="font-icon icon iconfont icon-note" style=""></span>其他</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>其他</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/posts/others/ArknightsDrawAgent.html" class="nav-link" aria-label="代抽研究"><span class="font-icon icon iconfont icon-software" style=""></span>代抽研究<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="https://theme-hope.vuejs.press/zh/" rel="noopener noreferrer" target="_blank" aria-label="V2 文档" class="nav-link"><span class="font-icon icon iconfont icon-note" style=""></span>V2 文档<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!--[--><div class="nav-item"><div class="dropdown-wrapper i18n-dropdown"><button type="button" class="dropdown-title" aria-label="选择语言"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon i18n-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="i18n icon" style="width:1rem;height:1rem;vertical-align:middle;"><path d="M379.392 460.8 494.08 575.488l-42.496 102.4L307.2 532.48 138.24 701.44l-71.68-72.704L234.496 460.8l-45.056-45.056c-27.136-27.136-51.2-66.56-66.56-108.544h112.64c7.68 14.336 16.896 27.136 26.112 35.84l45.568 46.08 45.056-45.056C382.976 312.32 409.6 247.808 409.6 204.8H0V102.4h256V0h102.4v102.4h256v102.4H512c0 70.144-37.888 161.28-87.04 210.944L378.88 460.8zM576 870.4 512 1024H409.6l256-614.4H768l256 614.4H921.6l-64-153.6H576zM618.496 768h196.608L716.8 532.48 618.496 768z"></path></svg><!--]--><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html" class="router-link-active router-link-exact-active nav-link active" aria-label="简体中文"><!---->简体中文<!----></a></li><li class="dropdown-item"><a href="/en-US/" class="nav-link" aria-label="English"><!---->English<!----></a></li></ul></button></div></div><div class="nav-item"><a class="repo-link" href="https://github.com/vuepress-theme-hope/vuepress-theme-hope" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!--[--><!----><!--]--><button type="button" class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/" class="nav-link sidebar-link sidebar-page" aria-label="主页"><span class="font-icon icon iconfont icon-home" style=""></span>主页<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><p class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-creative" style=""></span><a href="/demo/" class="nav-link title" aria-label="如何使用"><!---->如何使用<!----></a><!----></p><ul class="sidebar-links"><li><!--[--><a href="/demo/page.html" class="nav-link sidebar-link sidebar-page" aria-label="页面配置"><span class="font-icon icon iconfont icon-page" style=""></span>页面配置<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/demo/markdown.html" class="nav-link sidebar-link sidebar-page" aria-label="Markdown 展示"><span class="font-icon icon iconfont icon-markdown" style=""></span>Markdown 展示<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/demo/disable.html" class="nav-link sidebar-link sidebar-page" aria-label="布局与功能禁用"><span class="font-icon icon iconfont icon-config" style=""></span>布局与功能禁用<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/demo/encrypt.html" class="nav-link sidebar-link sidebar-page" aria-label="密码加密的文章"><span class="font-icon icon iconfont icon-lock" style=""></span>密码加密的文章<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><p class="sidebar-heading"><span class="font-icon icon iconfont icon-study" style=""></span><span class="title">游戏程序高级知识</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/game_dev/advance/SurfaceSample.html" class="nav-link sidebar-link sidebar-page" aria-label="程序化生成地图相关算法"><span class="font-icon icon iconfont icon-note" style=""></span>程序化生成地图相关算法<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/game_dev/advance/NavMap.html" class="nav-link sidebar-link sidebar-page" aria-label="NavMap 地图框架研究"><span class="font-icon icon iconfont icon-note" style=""></span>NavMap 地图框架研究<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><p class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-repo" style=""></span><a href="/the_unity_shader_bible/" class="nav-link title" aria-label="Unity 着色器圣经"><!---->Unity 着色器圣经<!----></a><!----></p><ul class="sidebar-links"></ul></section></li><li><section class="sidebar-group"><p class="sidebar-heading"><span class="font-icon icon iconfont icon-note" style=""></span><span class="title">其他文章</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/posts/others/ArknightsDrawAgent.html" class="nav-link sidebar-link sidebar-page" aria-label="明日方舟代抽的相关研究"><span class="font-icon icon iconfont icon-software" style=""></span>明日方舟代抽的相关研究<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/posts/others/propagating_velocities_through_animation_systems.html" class="nav-link sidebar-link sidebar-page" aria-label="通过动画系统的传播速度(暂定)"><span class="font-icon icon iconfont icon-software" style=""></span>通过动画系统的传播速度(暂定)<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/posts/others/Requirements.html" class="nav-link sidebar-link sidebar-page" aria-label="需求文档"><!---->需求文档<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/posts/others/Yabot.html" class="nav-link sidebar-link sidebar-page" aria-label="Yabot 开发文档"><!---->Yabot 开发文档<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><span class="font-icon icon iconfont icon-code" style=""></span>属性、命令和函数</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://saltsakya.github.io" target="_blank" rel="noopener noreferrer">舒服嘉</a></span><span property="author" content="舒服嘉"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2022-06-11T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 27 分钟</span><meta property="timeRequired" content="PT27M"></span><span class="page-category-info" aria-label="分类🌈" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item category0 clickable" role="navigation">Unity Shader 圣经</span><!--]--><meta property="articleSection" content="Unity Shader 圣经"></span><span class="page-tag-info" aria-label="标签🏷" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item tag0 clickable" role="navigation">shader</span><span class="page-tag-item tag8 clickable" role="navigation">Unity</span><span class="page-tag-item tag3 clickable" role="navigation">CG</span><!--]--><meta property="keywords" content="shader,Unity,CG"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-1-顶点-片元着色器的结构" class="router-link-active router-link-exact-active toc-link level2">3.1 顶点/片元着色器的结构</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-2-shaderlab-着色器" class="router-link-active router-link-exact-active toc-link level2">3.2 ShaderLab 着色器</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-3-shaderlab-属性" class="router-link-active router-link-exact-active toc-link level2">3.3 ShaderLab 属性</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-3-1-数字与滑块属性" class="router-link-active router-link-exact-active toc-link level3">3.3.1 数字与滑块属性</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-3-2-颜色与向量属性" class="router-link-active router-link-exact-active toc-link level3">3.3.2 颜色与向量属性</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-3-3-纹理属性" class="router-link-active router-link-exact-active toc-link level3">3.3.3 纹理属性</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-4-材质属性绘制器" class="router-link-active router-link-exact-active toc-link level2">3.4 材质属性绘制器</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-4-1-mpd-开关" class="router-link-active router-link-exact-active toc-link level3">3.4.1 MPD 开关</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-4-2-mpd-关键字枚举" class="router-link-active router-link-exact-active toc-link level3">3.4.2 MPD 关键字枚举</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-4-3-mpd-枚举" class="router-link-active router-link-exact-active toc-link level3">3.4.3 MPD 枚举</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-4-4-mpd-指数滑块和整型范围" class="router-link-active router-link-exact-active toc-link level3">3.4.4 MPD 指数滑块和整型范围</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-4-5-mpd-空格和标题" class="router-link-active router-link-exact-active toc-link level3">3.4.5 MPD 空格和标题</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-5-shaderlab-子着色器" class="router-link-active router-link-exact-active toc-link level2">3.5 ShaderLab 子着色器</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-5-1-子着色器标签" class="router-link-active router-link-exact-active toc-link level3">3.5.1 子着色器标签</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-5-2-子着色器混合" class="router-link-active router-link-exact-active toc-link level3">3.5.2 子着色器混合</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-5-3-子着色器-alphatomask" class="router-link-active router-link-exact-active toc-link level3">3.5.3 子着色器 AlphaToMask</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-5-4-子着色器-colormask" class="router-link-active router-link-exact-active toc-link level3">3.5.4 子着色器 ColorMask</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-5-5-子着色器-culling-和深度测试" class="router-link-active router-link-exact-active toc-link level3">3.5.5 子着色器 Culling 和深度测试</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-5-6-子着色器-cull" class="router-link-active router-link-exact-active toc-link level3">3.5.6 子着色器 Cull</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-5-7-子着色器-zwrite" class="router-link-active router-link-exact-active toc-link level3">3.5.7 子着色器 ZWrite</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-5-8-子着色器-ztest" class="router-link-active router-link-exact-active toc-link level3">3.5.8 子着色器 ZTest</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-5-9-子着色器-stencil" class="router-link-active router-link-exact-active toc-link level3">3.5.9 子着色器 Stencil</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-6-子着色器通道" class="router-link-active router-link-exact-active toc-link level2">3.6 子着色器通道</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-6-1-cgprogram-endcg" class="router-link-active router-link-exact-active toc-link level3">3.6.1 CGPROGRAM / ENDCG</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-6-2-数据类型" class="router-link-active router-link-exact-active toc-link level3">3.6.2 数据类型</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-6-3-cg-hlsl-pragmas" class="router-link-active router-link-exact-active toc-link level3">3.6.3 Cg / HLSL Pragmas</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-6-4-cg-hlsl-include" class="router-link-active router-link-exact-active toc-link level3">3.6.4 Cg / HLSL Include</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-6-5-cg-hlsl-顶点输入与顶点输出" class="router-link-active router-link-exact-active toc-link level3">3.6.5 Cg / HLSL 顶点输入与顶点输出</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-6-6-cg-hlsl-变量和关联向量" class="router-link-active router-link-exact-active toc-link level3">3.6.6 Cg / HLSL 变量和关联向量</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-6-7-cg-hlsl-顶点着色器阶段" class="router-link-active router-link-exact-active toc-link level3">3.6.7 Cg / HLSL 顶点着色器阶段</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-6-8-cg-hlsl-片元着色器阶段" class="router-link-active router-link-exact-active toc-link level3">3.6.8 Cg / HLSL 片元着色器阶段</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.html#_3-7-子着色器回退" class="router-link-active router-link-exact-active toc-link level2">3.7 子着色器回退</a></li><!----><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><!-- more --><h2 id="_3-1-顶点-片元着色器的结构" tabindex="-1"><a class="header-anchor" href="#_3-1-顶点-片元着色器的结构" aria-hidden="true">#</a> 3.1 顶点/片元着色器的结构</h2><p>为了分析它的结构，我们要创建一个 <strong>Unlit 着色器</strong>并命名为“<strong>USB_simple_color</strong>”。 我们已经了解到，这种着色器是基础颜色模型，并且代码中没有过多的优化，这让我们可以深入分析其各种属性及方法。</p><p>当我们第一次创建材质时，Unity 会添加默认代码方便其编译过程。 在程序中，我们可以看见以这种 GPU 可以解释的方式组织的代码块。 如果我们打开 <strong>USB_simple_color</strong> 着色器，它的结构应该像这样：</p><details class="hint-container details"><summary>USB_simple_color 代码</summary><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code>Shader <span class="token string">&quot;Unlit/USB_simple_color&quot;</span>
<span class="token punctuation">{</span>
  Properties
  <span class="token punctuation">{</span>
    <span class="token function">_MainTex</span> <span class="token punctuation">(</span><span class="token string">&quot;Texture&quot;</span><span class="token punctuation">,</span> 2D<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&quot;white&quot;</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  SubShader
  <span class="token punctuation">{</span>
    Tags <span class="token punctuation">{</span><span class="token string">&quot;RenderType&quot;</span><span class="token operator">=</span><span class="token string">&quot;Opaque&quot;</span><span class="token punctuation">}</span>
    LOD <span class="token number">100</span>

    Pass
    <span class="token punctuation">{</span>
      CGPROGRAM
      <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">vertex vert</span></span>
      <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">fragment frag</span></span>
      <span class="token comment">// make fog work</span>
      <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">multi_compile_fog</span></span>

      <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;UnityCG.cginc&quot;</span></span>
      <span class="token keyword">struct</span> <span class="token class-name">appdata</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">float4</span> vertex <span class="token operator">:</span> POSITION<span class="token punctuation">;</span>
        <span class="token keyword">float2</span> uv <span class="token operator">:</span> TEXCOORD0<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>

      <span class="token keyword">struct</span> <span class="token class-name">v2f</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">float2</span> uv <span class="token operator">:</span> TEXCOORD0<span class="token punctuation">;</span>
        <span class="token function">UNITY_FOG_COORDS</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">float4</span> vertex <span class="token operator">:</span> SV_POSITION<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>

      <span class="token keyword">sampler</span> 2D _MainTex<span class="token punctuation">;</span>
      <span class="token keyword">float4</span> _MainTex<span class="token punctuation">;</span>

      v2f <span class="token function">vert</span> <span class="token punctuation">(</span>appdata v<span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        v2f o<span class="token punctuation">;</span>
        o<span class="token punctuation">.</span>vertex <span class="token operator">=</span> <span class="token function">UnityObjectToClipPos</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>vertex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        o<span class="token punctuation">.</span>uv <span class="token operator">=</span> <span class="token function">TRANSFORM_TEX</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>uv<span class="token punctuation">,</span> _MainTex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">UNITY_TRANSFER_FOG</span><span class="token punctuation">(</span>o<span class="token punctuation">,</span> o<span class="token punctuation">.</span>vertex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> o<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      fixed <span class="token function">frag</span> <span class="token punctuation">(</span>v2f i<span class="token punctuation">)</span> <span class="token operator">:</span> SV_Target
      <span class="token punctuation">{</span>
        <span class="token comment">// sample the texture</span>
        fixed4 col <span class="token operator">=</span> <span class="token function">tex2D</span><span class="token punctuation">(</span>_MainTex<span class="token punctuation">,</span> i<span class="token punctuation">.</span>uv<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// apply fog</span>
        <span class="token function">UNITY_APPLY_FOG</span><span class="token punctuation">(</span>i<span class="token punctuation">.</span>fogCoord<span class="token punctuation">,</span> col<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> col<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      ENDCG
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><p>我们大概不完全理解我们刚创建的着色器中，不同的代码块中到底发生了什么。 但是，要开始我们的学习，我们需要关注它的常规结构。</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code>Shader <span class="token string">&quot;InspectorPath/shaderName&quot;</span>
<span class="token punctuation">{</span>
  Properties
  <span class="token punctuation">{</span>
    <span class="token comment">// properties in this field</span>
  <span class="token punctuation">}</span>

  SubShader
  <span class="token punctuation">{</span>
    <span class="token comment">// SubShader configuration in this field</span>
    Pass
    <span class="token punctuation">{</span>
      CGPROGRAM
      <span class="token comment">// programa Cg - HLSL in this field</span>
      ENDCG
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  Fallback <span class="token string">&quot;ExampleOtherShader&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div style="text-align:center;"><p>(Cg 和 HLSL 的着色器结构都是相同的，唯一的不同在于 Cg 和 HLSL <br> 的程序块。为了兼容性，两者都能在最新版的 Unity 中编译。)</p></div><p>前面的示例展示了着色器的主要结构。着色器以它在 <strong>Inspector</strong> 中的路径（InspectorPath）和<strong>名称</strong>（shaderName）开始，之后是<strong>属性</strong>（如材质、向量、颜色等），再之后是<strong>子材质</strong>，最后是可选的<strong>回退</strong>。</p><p>“InspectorPath”代表我们要选择要应用到材质的着色器的位置。 这个选择是在 Unity 的 Inspector 中进行的。</p><p>我们要记住，我们不能直接将着色器应用到一个多边形物体上，我们需要先创建一个材质，才能将其应用到多边形物体上。 我们的 USB_simple_color 着色器默认路径是“Unlit”，这意味着：对于 Unity，我们需要先选择我们的材质，在 Inspector 面板中，找到路径 Unlit 并应用 USB_simple_color。</p><p>我们必须要知道的一个结构因素是，GPU 会从上到下线性地阅读代码，因此如果我们快速创建了一个函数，并把它写在了使用它的代码块下方，GPU 就无法阅读到它，于是就会在着色器处理中产生一个错误，于是回退就会指定另一个着色器，以便显卡可以继续其处理。</p><p>让我们做个小练习来理解这个概念。</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code><span class="token comment">// 1. declare out function 定义我们的函数</span>
<span class="token keyword">float4</span> <span class="token function">ourFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token comment">// your code here ... 代码写在这里...</span>
<span class="token punctuation">}</span>
<span class="token comment">// 2. we use the function 使用函数</span>
fixed4 <span class="token function">frag</span> <span class="token punctuation">(</span>v2f i<span class="token punctuation">)</span> <span class="token operator">:</span> SV_Target
<span class="token punctuation">{</span>
  <span class="token comment">// we are using the function here 在这里使用我们的函数</span>
  <span class="token keyword">float4</span> f <span class="token operator">=</span> <span class="token function">ourFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> f<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上述函数的与语法可能无法完全理解。 创建这些只是为了概念化一个函数与另一个函数的位置关系。</p><p>在 <a href="/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/implementation_and_other_concepts.html#_4-4-hlsl-%E4%B8%AD%E7%9A%84%E5%87%BD%E6%95%B0%E7%BB%93%E6%9E%84" class="">4.0.4 节</a>我们会详细介绍函数的结构。 现在，我们只要知道上述例子的结构是正确的，因为函数 <code>ourFunction</code> 已经在代码块被放置的位置写过了。 GPU 会先读到 <code>ourFunction</code> 然后才继续执行片元阶段 <code>frag</code>。</p><p>让我们看看另一种情况。</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code><span class="token comment">// 2. we use the function 使用函数</span>
fixed4 <span class="token function">frag</span> <span class="token punctuation">(</span>v2f i<span class="token punctuation">)</span> <span class="token operator">:</span> SV_Target
<span class="token punctuation">{</span>
  <span class="token comment">// we are using the function here 在这里使用我们的函数</span>
  <span class="token keyword">float4</span> f <span class="token operator">=</span> <span class="token function">ourFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> f<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 1. declare out function 定义我们的函数</span>
<span class="token keyword">float4</span> <span class="token function">ourFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token comment">// your code here ... 代码写在这里...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>相对的，这个结构会产生一个“错误”，因为函数 <code>ourFunction</code> 被写在了使用它的地方下面。</p><h2 id="_3-2-shaderlab-着色器" tabindex="-1"><a class="header-anchor" href="#_3-2-shaderlab-着色器" aria-hidden="true">#</a> 3.2 ShaderLab 着色器</h2><p>我们编写着色器代码时，大多数都将从<strong>着色器</strong>的生命开始，随后是它在 <strong>Inspector</strong> 中的路径，最后是我们指定给它的<strong>名称</strong>（形如着色器“shader inspector path / shader name”）。</p><p>子着色器和回退之类的属性都是写在 ShaderLab 声明性语言的 “Shader” 域中的。</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code>Shader <span class="token string">&quot;InspectorPath/shaderName&quot;</span>
<span class="token punctuation">{</span>
  <span class="token comment">// write ShaderLab code here 此处编写 ShaderLab 代码</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>因为 USB_simple_color 已经默认声明了 “Unlit/USB_simple_color”，如果我们要将其指定给一个材质，我们就需要在 Unity 的 Inspector 中，找到 Unlit 路径，并选择“USB_simple_color”。</p><p>路径和名称都可以根据项目的规范要求来更改。</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code><span class="token comment">// default value 默认值</span>
Shader <span class="token string">&quot;Unlit / USB_simple_color&quot;</span>
<span class="token punctuation">{</span>
  <span class="token comment">// write ShaderLab code here 此处编写 ShaderLab 代码</span>
<span class="token punctuation">}</span>

<span class="token comment">// customize path to USB (Unity Shader Bible) Unity 着色器圣经的自定义路径</span>
Shader <span class="token string">&quot;USB / USB_simple_color&quot;</span>
<span class="token punctuation">{</span>
  <span class="token comment">// write ShaderLab code here 此处编写 ShaderLab 代码</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-3-shaderlab-属性" tabindex="-1"><a class="header-anchor" href="#_3-3-shaderlab-属性" aria-hidden="true">#</a> 3.3 ShaderLab 属性</h2><p>属性对应可在 Unity 的 Inspector 中调整的一系列参数。 共有 8 种数值和用处各不相同的属性。 无论是在动态地还是运行时，我们都可以使用这些与我们要创建或修改的着色器相关属性。 声明一个属性的语法如下：</p><div class="language-hsls line-numbers-mode" data-ext="hsls"><pre class="language-hsls"><code>PropertyName (&quot;display name&quot;, type) = defaultValue
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>&quot;<strong>PropertyName</strong>&quot;表示属性名（如：_MainTex）， &quot;<strong>display name</strong>&quot;对应在 Unity 的 Inspector 中显示的属性名（如：Texture）， &quot;<strong>type</strong>&quot;指定了属性的类型（如：Color、Vector、2D 等）， 最后，顾名思义，&quot;<strong>defaultValue</strong>&quot;是指定给属性的默认值（例如，如果我们的属性是一个 “Color” 类型，我们可以设置它的默认值为 (1, 1, 1, 1)）。</p><figure><img src="/unityshaderbible/44-0.png" alt="图 3.3a" tabindex="0" loading="lazy"><figcaption>图 3.3a</figcaption></figure><p>细看我们的 USB_simple_color 的<em>属性</em>，我们会注意到在属性域中已经声明了一个纹理属性，我们可以从下面这行代码中证实这一点。</p><div class="language-hsls line-numbers-mode" data-ext="hsls"><pre class="language-hsls"><code>Properties
{
  _MainTex (&quot;Texture&quot;, 2D) = &quot;white&quot; {}
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>需要考虑的一点是，当我们声明属性时，它要在属性域中保持“开放”的状态，因此我们要避免在代码行末尾添加分号（；），否则 GPU 会无法读取程序。</p><h3 id="_3-3-1-数字与滑块属性" tabindex="-1"><a class="header-anchor" href="#_3-3-1-数字与滑块属性" aria-hidden="true">#</a> 3.3.1 数字与滑块属性</h3><p>这些类型的属性让我们可以在 Shader 中添加数值。 假设我们要创建一个有照明功能的着色器，其中 0 表示 0% 照明，而 1 表示 100% 照明。我们可以为其创建一个范围（例如 Range(min, max)），并配置最小、最大和默认照明值。</p><p>下面的语法在着色器中声明了数字和滑块。</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code><span class="token comment">// name (&quot;display name&quot;, Range(min, max)) = defaultValue</span>
<span class="token comment">// name (&quot;display name&quot;, Float) = defaultValue</span>
<span class="token comment">// name (&quot;display name&quot;, Int) = defaultValue</span>

Shader <span class="token string">&quot;InspectorPath/shaderName&quot;</span>
<span class="token punctuation">{</span>
  Properties
  <span class="token punctuation">{</span>
    <span class="token function">_Specular</span> <span class="token punctuation">(</span><span class="token string">&quot;Specular&quot;</span><span class="token punctuation">,</span> <span class="token function">Range</span><span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0.3</span>
    <span class="token function">_Factor</span> <span class="token punctuation">(</span><span class="token string">&quot;Color Factor&quot;</span><span class="token punctuation">,</span> Float<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0.3</span>
    <span class="token function">_Cid</span> <span class="token punctuation">(</span><span class="token string">&quot;Color id&quot;</span><span class="token punctuation">,</span> Int<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">2</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上方的示例中，我们声明了三个属性，一个是名为 <strong>_Specular</strong> 的“浮点区间”类型，另一个是名为 <strong>_Factor</strong> 的“浮点缩放”类型，最后是一个叫 <strong>_Cid</strong> 的“整数”类型。</p><h3 id="_3-3-2-颜色与向量属性" tabindex="-1"><a class="header-anchor" href="#_3-3-2-颜色与向量属性" aria-hidden="true">#</a> 3.3.2 颜色与向量属性</h3><p>在这个属性中，我们可以在着色器中定义颜色或向量。</p><p>假设我们要创建一个可以在执行期间改变颜色的着色器，为此我们需要添加一个颜色属性，让我们可以修改着色器的 RGBA 值。</p><p>使用下面的语法在着色器中声明颜色和向量：</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code><span class="token comment">// name (&quot;display name&quot;, Color) = (R, G, B, A)</span>
<span class="token comment">// name (&quot;display name&quot;, Vector) = (0, 0, 0, 1)</span>

Shader <span class="token string">&quot;InspectorPath/shaderName&quot;</span>
<span class="token punctuation">{</span>
  Properties
  <span class="token punctuation">{</span>
    <span class="token function">_Color</span> <span class="token punctuation">(</span><span class="token string">&quot;Tint&quot;</span><span class="token punctuation">,</span> Color<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token function">_VPos</span> <span class="token punctuation">(</span><span class="token string">&quot;Vertex Position&quot;</span><span class="token punctuation">,</span> Vector<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上方的示例中，我们声明了两个属性，一个名为 <strong>_Color</strong> 的“颜色”类型， 和一个名为 <strong>_VPos</strong> 的“向量”类型。</p><h3 id="_3-3-3-纹理属性" tabindex="-1"><a class="header-anchor" href="#_3-3-3-纹理属性" aria-hidden="true">#</a> 3.3.3 纹理属性</h3><p>这些属性让我们可以在着色器中实现纹理。</p><p>如果我们想在我们的物体（例如一个 3D 角色）上放一张纹理，我们需要为其添加一个 2D 属性作为纹理，随后通过一个名为“tex2D”的函数传入，这个函数需要两个参数：模型的纹理和UV坐标。</p><p>在电子游戏中常用的一个属性是“Cube”，它代表一个“立方贴图”，这种纹理在生成反射贴图时非常有用，例如，角色盔甲和金属元素的反射。</p><p>另一种我们能见到的贴图是 3D 类型的。这类贴图不像前一个那么常用，因为它是有体积的，并且有为空间计算的额外坐标。</p><p>如下语法可以在着色器种声明贴图：</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code><span class="token comment">// name (&quot;display name&quot;, 2D) = &quot;defaultColorTexture&quot;</span>
<span class="token comment">// name (&quot;display name&quot;, Cube) = &quot;defaultColorTexture&quot;</span>
<span class="token comment">// name (&quot;display name&quot;, 3D) = &quot;defaultColorTexture&quot;</span>

Shader <span class="token string">&quot;InspectorPath/shaderName&quot;</span>
<span class="token punctuation">{</span>
  Properties
  <span class="token punctuation">{</span>
    <span class="token function">_MainTex</span> <span class="token punctuation">(</span><span class="token string">&quot;Texture&quot;</span><span class="token punctuation">,</span> 2D<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&quot;white&quot;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token function">_Reflection</span> <span class="token punctuation">(</span><span class="token string">&quot;Reflection&quot;</span><span class="token punctuation">,</span> Cube<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&quot;black&quot;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token function">_3DTexture</span> <span class="token punctuation">(</span><span class="token string">&quot;3D Texture&quot;</span><span class="token punctuation">,</span> 3D<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&quot;white&quot;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>有件很重要的事要考虑，那就是我们在声明属性的时候是写在 ShaderLab 声明性语言中，而程序则是写在 Cg 或 HLSL 语言中。 因为他们是两种不同的语言，所以我们需要创建“<strong>连接变量</strong>”</p><p>这些变量使用“uniform”全局声明，不过这一步可以跳过，因为程序会把它们识别为全局变量。 因此，要为“.shader”添加一个属性，我们必须先在 ShaderLab 中声明，然后在 Cg 或 HLSL 中声明同名变量，最后我们就可以使用了。</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code>Shader <span class="token string">&quot;InspectorPath/shaderName&quot;</span>
<span class="token punctuation">{</span>
  Properties
  <span class="token punctuation">{</span>
    <span class="token comment">// declare the properties 声明属性</span>
    <span class="token function">_MainTex</span> <span class="token punctuation">(</span><span class="token string">&quot;Texture&quot;</span><span class="token punctuation">,</span> 2D<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&quot;white&quot;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token function">_Color</span> <span class="token punctuation">(</span><span class="token string">&quot;Color&quot;</span><span class="token punctuation">,</span> Color<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  SubShader
  <span class="token punctuation">{</span>
    Pass
    <span class="token punctuation">{</span>
      CGPROGRAM
      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
      <span class="token comment">// add connection variables 添加连接变量</span>
      sampler2D _MainTex<span class="token punctuation">;</span>
      <span class="token keyword">float4</span> _Color<span class="token punctuation">;</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
      <span class="token keyword">half4</span> <span class="token function">frag</span> <span class="token punctuation">(</span>v2f i<span class="token punctuation">)</span> <span class="token operator">:</span> SV_Target
      <span class="token punctuation">{</span>
        <span class="token comment">// use the variables 使用变量</span>
        <span class="token keyword">half4</span> col <span class="token operator">=</span> <span class="token function">tex2D</span><span class="token punctuation">(</span>_MainTex<span class="token punctuation">,</span> i<span class="token punctuation">.</span>uv<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> col <span class="token operator">*</span> _Color<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      ENDCG
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个例子中，我们声明了两个属性：<strong>_MainTex</strong> 和 <strong>_Color</strong>。 之后我们在 CGPROGRAM 中创建了两个连接变量，他们对应了 <code>sampler2D _MainTex</code> 和 <code>float4 _Color</code>。 两个属性和两个连接变量必须有相同的名字，以便程序可以识别。</p><p>我们会在<a href="#">3.27 节</a> <mark>讲解关</mark>于数据类型的地方细说 2D 采样器的运算。</p><h2 id="_3-4-材质属性绘制器" tabindex="-1"><a class="header-anchor" href="#_3-4-材质属性绘制器" aria-hidden="true">#</a> 3.4 材质属性绘制器</h2><p>另一种我们可以在 ShaderLab 中找到的属性是“绘制器”（Drawer）。 这个类让我们可以在 Unity 的 Inspector 中生成自定义属性，从而促进着色器的条件编程。</p><p>默认情况下，这类属性没有包含在我们的着色器中，因此我们需要根据我们的需要进行声明。 目前为止，有七种不同的绘制器：</p><ul><li><strong>Toggle</strong>（开关）</li><li><strong>Enum</strong>（枚举）</li><li><strong>KeywordEnum</strong>（关键字枚举）</li><li><strong>PowerShlider</strong>（指数滑块）</li><li><strong>IntRange</strong>（整型范围）</li><li><strong>Space</strong>（空格）</li><li><strong>Header</strong>（标题）</li></ul><p>它们每一个都有特定的函数，且独立声明。</p><p>有了这些属性，我们可以在程序中生成多种状态，让我们无需运行时改变材质，即可创建动态效果。 我们通常和两种<strong>着色器变体</strong>一起使用这些绘制器，它们是 <strong>#pragma multi_compile</strong> 和 <strong>#shader_feature</strong>。</p><figure><img src="/unityshaderbible/49-0.png" alt="图 3.4a" tabindex="0" loading="lazy"><figcaption>图 3.4a</figcaption></figure><h3 id="_3-4-1-mpd-开关" tabindex="-1"><a class="header-anchor" href="#_3-4-1-mpd-开关" aria-hidden="true">#</a> 3.4.1 MPD 开关</h3><p>在 ShaderLab 中，我们无法使用布尔类型参数，但是我们有 Toggle 可以实现同样的功能。 这个绘制器可以让我们通过条件来切换状态。 要使用它，我们要先在中括号之间写一个 <code>Toggle</code>，然后声明属性，注意，这个属性必须是 <code>Float</code> 类型的。 它的默认值必须是一个 <code>Integer</code>，0 或 1，为啥？因为 0 象征“关”，而 1 象征“开”。</p><p>其语法如下：</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code><span class="token punctuation">[</span>Toggle<span class="token punctuation">]</span> <span class="token function">_PropertyName</span> <span class="token punctuation">(</span><span class="token string">&quot;Display Name&quot;</span><span class="token punctuation">,</span> Float<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>如你所见，我们在中括号内添加了 Toggle，并声明了属性，接着是显示名，然后是 Float 数据类型，最后我们初始化属性为“关”，因为我们将它的默认值设定为 0。</p><p>在使用这种绘制器的时候要注意，如果我们想在代码中实现它，需要使用 <code>#pragma shader_feature</code>。 这是一种着色器变体，它的功能是根据输入（启用或禁用）产生不同的状态。 要理解它的执行情况，我们需要做以下操作：</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code>Shader <span class="token string">&quot;InspectorPath/shaderName&quot;</span>
<span class="token punctuation">{</span>
  Properties
  <span class="token punctuation">{</span>
    <span class="token function">_Color</span> <span class="token punctuation">(</span><span class="token string">&quot;Color&quot;</span><span class="token punctuation">,</span> Color<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token comment">// declare drawer Toggle 声明开关</span>
    <span class="token punctuation">[</span>Toggle<span class="token punctuation">]</span> <span class="token function">_Enable</span> <span class="token punctuation">(</span><span class="token string">&quot;Enable ?&quot;</span><span class="token punctuation">,</span> Float<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token punctuation">}</span>

  SubShader
  <span class="token punctuation">{</span>
    Pass
    <span class="token punctuation">{</span>
      CGPROGRAM
      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
      <span class="token comment">// declare pragma 声明 pragma</span>
      <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">shader_feature _ENABLE_ON</span></span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
      <span class="token keyword">float4</span> _Color<span class="token punctuation">;</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
      <span class="token keyword">half4</span> <span class="token function">frag</span> <span class="token punctuation">(</span>v2f i<span class="token punctuation">)</span> <span class="token operator">:</span> SV_Target
      <span class="token punctuation">{</span>
        <span class="token keyword">half4</span> col <span class="token operator">=</span> <span class="token function">tex2D</span><span class="token punctuation">(</span>_MainTex<span class="token punctuation">,</span> i<span class="token punctuation">.</span>uv<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// generate conditions 生成状态</span>
      <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression">_ENABLE_ON</span></span>
        <span class="token keyword">return</span> col<span class="token punctuation">;</span>
      <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span></span>
        <span class="token keyword">return</span> col <span class="token operator">*</span> _Color<span class="token punctuation">;</span>
      <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
      <span class="token punctuation">}</span>
      ENDCG
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个例子中，我们声明了一个 Toggle 类型的属性 <code>_Enable</code>。 接着我们将其添加到 CGPROGRAM 的 <strong>shader_feature</strong> 中，然而，不同于程序中的属性，Toggle 被声明为 <code>_ENABLE_ON</code>，为何如此？ 添加到 shader_feature 变体中的变量是常量，因此是大写的，这意味着，如果我们的属性叫 <code>_Change</code>，那在着色器变体中，它需要添加为 <code>_CHANGE</code>。 而 <strong>_ON</strong> 对应 Toggle 的默认状态，因此，如果激活了 <code>_Enable</code> 属性，我们在片元着色阶段返回默认纹理颜色，否则我们将其乘上 <code>_Color</code> 属性。</p><p>值得一提的是，shader_feature 无法为一个应用编译多个变体，这是什么意思？ Unity 不会在最终构建中包含没有使用的变体，这意味着我们不能在运行时从一个状态移到另一个状态。 为此，我们得使用有“<strong>multi_compile</strong>”着色器变体的 KeywordEnum 绘制器。</p><h3 id="_3-4-2-mpd-关键字枚举" tabindex="-1"><a class="header-anchor" href="#_3-4-2-mpd-关键字枚举" aria-hidden="true">#</a> 3.4.2 MPD 关键字枚举</h3><p>这种绘制器会在材质 inspector 中生成一个<strong>弹出式</strong>菜单。 不同于 Toggle，这种绘制器让我们可以为着色器配置 9 种不同的状态。 为此我们必须在中括号添加 <code>KeywordEnum</code>，然后列出我们要用到的状态集合。</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code><span class="token punctuation">[</span><span class="token function">KeywordEnum</span><span class="token punctuation">(</span>StateOff<span class="token punctuation">,</span> State01<span class="token punctuation">,</span> etc<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token function">_PropertyName</span> <span class="token punctuation">(</span><span class="token string">&quot;Display name&quot;</span><span class="token punctuation">,</span> Float<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>这个例子中，我们在中括号中添加了 KeywordEnum 绘制器，然后列出了它的状态，这里第一个状态对应默认状态（StateOff）。 紧接着是属性的声明、在材质 inspector 种显示的名字、其 Float 数据类型和我们在最后初始化的默认值。</p><p>要在代码中声明这种绘制器，<strong>shader_feature</strong> 和 <strong>multi_compile</strong> 两种着色器变体都是可用的。 我们可以基于想要在最终构建中包含的变体数量来选择。</p><p>正如我们已经知道的，<code>shader_feature</code> 只会导出在材质 inspector 中选择的变体，而 <code>multi_compile</code> 则会导出所有在着色器中找到的变体，不论是否用到了它们。 有了这个特点，<code>multi_compile</code> 更适合导出或是编译多种会在执行期间改变的状态（如《超级马里奥》中的星星状态）。</p><p>为理解其实现，我们将执行以下操作：</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code>Shader <span class="token string">&quot;InscpectorPath/shaderName&quot;</span>
<span class="token punctuation">{</span>
  Properties
  <span class="token punctuation">{</span>
    <span class="token comment">// declare drawer Toggle</span>
    <span class="token punctuation">[</span><span class="token function">KeywordEnum</span><span class="token punctuation">(</span>Off<span class="token punctuation">,</span> Red<span class="token punctuation">,</span> Blue<span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token function">_Options</span> <span class="token punctuation">(</span><span class="token string">&quot;Color Options&quot;</span><span class="token punctuation">,</span> Float<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token punctuation">}</span>
  SubShader
  <span class="token punctuation">{</span>
    Pass
    <span class="token punctuation">{</span>
      CGPROGRAM
      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
      <span class="token comment">// declare pragma and conditions</span>
      <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">multi_compile _OPTIONS_OFF _OPTIONS_RED _OPTIONS_BLUE</span></span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
      <span class="token keyword">half4</span> <span class="token function">frag</span> <span class="token punctuation">(</span>v2f i<span class="token punctuation">)</span> <span class="token operator">:</span> SV_Target
      <span class="token punctuation">{</span>
        <span class="token keyword">half4</span> col <span class="token operator">=</span> <span class="token function">tex2D</span><span class="token punctuation">(</span>_MainTex<span class="token punctuation">,</span> i<span class="token punctuation">.</span>uv<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// generate conditions</span>
      <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression">_OPTIONS_OFF</span></span>
        <span class="token keyword">return</span> col<span class="token punctuation">;</span>
      <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">elif</span> <span class="token expression">_OPTIONS_RED</span></span>
        <span class="token keyword">return</span> col <span class="token operator">*</span> <span class="token keyword">float4</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">elif</span> <span class="token expression">_OPTIONS_BLUE</span></span>
        <span class="token keyword">return</span> col <span class="token operator">*</span> <span class="token keyword">float4</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
      <span class="token punctuation">}</span>
      ENDCG
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个例子中，我们声明了一个 KeywordEnum 类型属性，名为 <code>_Options</code>，并给它配置了三种状态（<code>Off</code>、<code>Red</code> 和 <code>Blue</code>）。 之后我们将他们添加到了 <code>CGPROGRAM</code> 中的 <code>multi_compile</code>，并将它们声明为常量。</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">pragma</span> <span class="token expression">multi_compile _OPTIONS_OFF _OPTIONS_RED _OPTIONS_BLUE</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>最后使用这三种状态，我们为着色器定义了定义了这三种状态，对应改变主纹理的颜色。</p><h3 id="_3-4-3-mpd-枚举" tabindex="-1"><a class="header-anchor" href="#_3-4-3-mpd-枚举" aria-hidden="true">#</a> 3.4.3 MPD 枚举</h3><p>Enum 绘制器和 KeywordEnum 很相似，区别在于它可以定义一个“值/id”作为参数，并将其传入着色器中，以在 inspector 中动态地改变其功能。</p><p>其语法如下：</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code><span class="token punctuation">[</span><span class="token function">Enum</span><span class="token punctuation">(</span>valor<span class="token punctuation">,</span> id_00<span class="token punctuation">,</span> valor<span class="token punctuation">,</span> id_01<span class="token punctuation">,</span> etc <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token function">_PropertyName</span> <span class="token punctuation">(</span><span class="token string">&quot;Display Name&quot;</span><span class="token punctuation">,</span> Float<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><code>Enum</code> 不使用着色器变体，而是通过命令或函数来声明。 为了理解其实现，我们来执行下面的操作：</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code>Shader <span class="token string">&quot;InspectorPath/shaderName&quot;</span>
<span class="token punctuation">{</span>
  Properties
  <span class="token punctuation">{</span>
    <span class="token comment">// declare drawer 声明绘制器</span>
    <span class="token punctuation">[</span><span class="token function">Enum</span><span class="token punctuation">(</span>Off<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Front<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> Back<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token function">_Face</span> <span class="token punctuation">(</span><span class="token string">&quot;Face Culling&quot;</span><span class="token punctuation">,</span> Float<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token punctuation">}</span>
  SubShader
  <span class="token punctuation">{</span>
    <span class="token comment">// we use the property as a command 我们以命令的形式使用这个属性</span>
    Cull <span class="token punctuation">[</span>_Face<span class="token punctuation">]</span>
    Pass <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在给出的例子中，我们声明了一个 <code>Enum</code> 属性，名为 <code>_Face</code>，并将其值作为参数传递：Off：0、Front：1、Back：2。 之后我们将属性添加到子着色器中的 <code>Cull</code> 命令。 这样一来，我们就可以在 Unity 的 Inspector 中修改要渲染的物体表面。 在 <a href="">3.2.1 节</a><mark>中我们会详细讲解 <code>Cull</code> 命令。</mark></p><h3 id="_3-4-4-mpd-指数滑块和整型范围" tabindex="-1"><a class="header-anchor" href="#_3-4-4-mpd-指数滑块和整型范围" aria-hidden="true">#</a> 3.4.4 MPD 指数滑块和整型范围</h3><p>这些绘制器在处理数值范围和精度时很有用。 首先，我们可以用 <code>PowerSlider</code> 来生成用曲线控制的非线性的滑块。</p><p>其语法如下：</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code><span class="token punctuation">[</span><span class="token function">PowerSlider</span><span class="token punctuation">(</span><span class="token number">3.0</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token function">_PropertyName</span> <span class="token punctuation">(</span><span class="token string">&quot;Display name&quot;</span><span class="token punctuation">,</span> <span class="token function">Range</span> <span class="token punctuation">(</span><span class="token number">0.01</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0.08</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>另一方面，还有 <code>IntRange</code>，顾名思义，为整数值添加一个数字范围。</p><p>其语法如下：</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code><span class="token punctuation">[</span>IntRange<span class="token punctuation">]</span> <span class="token function">_Property</span> <span class="token punctuation">(</span><span class="token string">&quot;Display name&quot;</span><span class="token punctuation">,</span> <span class="token function">Range</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">100</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>注意，如果我们想在着色器中使用这些属性，就要像传统属性一样声明在 <code>CGPROGRAM</code> 中。 要理解如何使用它，我们将执行以下操作：</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code>Shader <span class="token string">&quot;InspectorPath/shaderName&quot;</span>
<span class="token punctuation">{</span>
  Properties
  <span class="token punctuation">{</span>
    <span class="token comment">// declare drawer 声明绘制器</span>
    <span class="token punctuation">[</span><span class="token function">PowerSlider</span><span class="token punctuation">(</span><span class="token number">3.0</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token function">_Brightness</span> <span class="token punctuation">(</span><span class="token string">&quot;Brightness&quot;</span><span class="token punctuation">,</span> <span class="token function">Range</span> <span class="token punctuation">(</span><span class="token number">0.01</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0.08</span>
    <span class="token punctuation">[</span>IntRange<span class="token punctuation">]</span>
    <span class="token function">_Sample</span> <span class="token punctuation">(</span><span class="token string">&quot;Samples&quot;</span><span class="token punctuation">,</span> <span class="token function">Range</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">100</span>
  <span class="token punctuation">}</span>
  SubShader
  <span class="token punctuation">{</span>
    Pass
    <span class="token punctuation">{</span>
      CGPROGRAM
      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
      <span class="token comment">// generate connection variables 生成连接变量</span>
      <span class="token keyword">float</span> _Brightness<span class="token punctuation">;</span>
      <span class="token keyword">int</span> _Samples<span class="token punctuation">;</span>
      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
      ENGCG
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个例子中，我们声明了名为 <code>_Brightness</code> 的 <code>PowerSlider</code> 和一个名为 <code>_Samples</code> 的 <code>IntRange</code>。 最后使用相同的名字在 <code>CGPROGRAM</code> 中生成连接变量。</p><h3 id="_3-4-5-mpd-空格和标题" tabindex="-1"><a class="header-anchor" href="#_3-4-5-mpd-空格和标题" aria-hidden="true">#</a> 3.4.5 MPD 空格和标题</h3><p>最后这些绘制器在组织上很有帮助。</p><p><code>Space</code> 让我们在两个属性之间添加空格。 如果我们像让属性之间在材质 Inspector 中有间隔，我们可以在它们中间添加这个绘制器。</p><p>其语法如下</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code><span class="token function">_PropertyName01</span> <span class="token punctuation">(</span><span class="token string">&quot;Display name&quot;</span><span class="token punctuation">,</span> Float <span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span>
<span class="token comment">// we add the space 添加空格</span>
<span class="token punctuation">[</span><span class="token function">Space</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token function">_PropertyName02</span> <span class="token punctuation">(</span><span class="token string">&quot;Display name&quot;</span><span class="token punctuation">,</span> Float <span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个例子中，我们在属性 <code>_PropertyName01</code> 和属性 <code>_PropertyName02</code> 之间添加了 10 点空格。 同样的，顾名思义，<code>Header</code> 可以在 Unity 的 Inspector 中添加一个标题。 这在在属性中生成目录很有用。</p><p>其语法如下：</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code><span class="token comment">// we add the header</span>
<span class="token punctuation">[</span><span class="token function">Header</span><span class="token punctuation">(</span>Category name<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token function">_PropertyName01</span> <span class="token punctuation">(</span><span class="token string">&quot;Display name&quot;</span><span class="token punctuation">,</span> Float <span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span>
<span class="token function">_PropertyName02</span> <span class="token punctuation">(</span><span class="token string">&quot;Display name&quot;</span><span class="token punctuation">,</span> Float <span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个例子中，我们在属性之前添加了一个小标题，这个标题会显示在 Inspector 中。 要理解两个属性，我们将执行以下操作：</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code>Shader <span class="token string">&quot;InspectorPath/shaderName&quot;</span>
<span class="token punctuation">{</span>
  Properties
  <span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token function">Header</span><span class="token punctuation">(</span>Specular properties<span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token function">_Specularity</span> <span class="token punctuation">(</span><span class="token string">&quot;Specularity&quot;</span><span class="token punctuation">,</span> <span class="token function">Range</span> <span class="token punctuation">(</span><span class="token number">0.01</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0.08</span>
    <span class="token function">_Brightness</span> <span class="token punctuation">(</span><span class="token string">&quot;Brightness&quot;</span><span class="token punctuation">,</span> <span class="token function">Range</span> <span class="token punctuation">(</span><span class="token number">0.01</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0.08</span>
    <span class="token function">_SpecularColor</span> <span class="token punctuation">(</span><span class="token string">&quot;Specular Color&quot;</span><span class="token punctuation">,</span> Color<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">[</span><span class="token function">Space</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token function">Header</span><span class="token punctuation">(</span>Texture properties<span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token function">_MainTex_</span> <span class="token punctuation">(</span><span class="token string">&quot;Texture&quot;</span><span class="token punctuation">,</span> 2D<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&quot;white&quot;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  SubShader <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-5-shaderlab-子着色器" tabindex="-1"><a class="header-anchor" href="#_3-5-shaderlab-子着色器" aria-hidden="true">#</a> 3.5 ShaderLab 子着色器</h2><p>着色器的第二个组件就是子着色器。 每个着色器由至少一个子着色器组成，以便完美加载程序。 当由不止一个子着色器时，Unity 会处理每个子着色器，并根据硬件特性从上到下选择最合适的一个。 为了理解这一点，假设着色器要在支持<strong>金属图形</strong>API（iOS）的硬件上运行。 为此，Unity 会运行第一个支持金属图形的子着色器。 如果一个子着色器不支持，Unity 会尝试使用对应一个默认着色器的回退组件，如此一来硬件就可以继续它的任务，而不会产生图形错误。</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code>Shader <span class="token string">&quot;InspectorPath/shaderName&quot;</span>
<span class="token punctuation">{</span>
  Properties <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
  SubShader
  <span class="token punctuation">{</span>
    <span class="token comment">// shader configuration here 在这里编写着色器配置</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果仔细看我们的 <code>USB_Simple_Color</code> 着色器，子着色器会默认像下面这样：</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code>Shader <span class="token string">&quot;USB_USB_simple_color&quot;</span>
<span class="token punctuation">{</span>
  Properties <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
  SubShader
  <span class="token punctuation">{</span>
    Tags <span class="token punctuation">{</span> <span class="token string">&quot;RenderType&quot;</span><span class="token operator">=</span><span class="token string">&quot;Opaque&quot;</span> <span class="token punctuation">}</span>
    LOD <span class="token number">100</span>

    Pass <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-5-1-子着色器标签" tabindex="-1"><a class="header-anchor" href="#_3-5-1-子着色器标签" aria-hidden="true">#</a> 3.5.1 子着色器标签</h3><p><strong>标签</strong>时显示我们的着色器如何以及何时处理的标签</p><p>就像 GameObject 的标签，这些可以用来识别一个着色器要如何渲染，或一组着色器有何种图形表现。</p><p>所有标签的语法如下：</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code>Tags
<span class="token punctuation">{</span>
  <span class="token string">&quot;TagName1&quot;</span><span class="token operator">=</span><span class="token string">&quot;TagValue1&quot;</span>
  <span class="token string">&quot;TagName2&quot;</span><span class="token operator">=</span><span class="token string">&quot;TagValue2&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这些可以写在两种不同的域中，即 <code>SubShader</code> 中或 <code>Pass</code> 中。 这取决于我们想要获得的效果。 如果我们把标签写在 <code>SubShader</code> 中，它会影响 <code>SubShader</code> 中包含的所有 <code>Pass</code>，而如果我们把它写在 <code>Pass</code> 中，则它只会影响选中的 <code>Pass</code>。</p><p><code>Queue</code> 是一种我们经常用到的标签，因为它让我们可以定义物体表面的外观。 默认情况下，所有的表面都被定义为 <code>opaque</code>，即它们不透明。</p><p>看看我们的 <code>USB_simple_shader</code>，我们会在子着色器中找到这一行代码，它将我们的着色器定义为不透明。</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code>SubShader
<span class="token punctuation">{</span>
  Tags <span class="token punctuation">{</span> <span class="token string">&quot;RenderType&quot;</span><span class="token operator">=</span><span class="token string">&quot;Opaque&quot;</span> <span class="token punctuation">}</span>
  LOD <span class="token number">100</span>

  Pass <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-5-1-1-queue-标签" tabindex="-1"><a class="header-anchor" href="#_3-5-1-1-queue-标签" aria-hidden="true">#</a> 3.5.1.1 Queue 标签</h4><p>默认情况下，这种标签并不会以代码的形式出现。 这是因为其默认在 GPU 上编译，它直接关联到每个材质的物体处理顺序。</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code>Tags <span class="token punctuation">{</span> <span class="token string">&quot;Queue&quot;</span><span class="token operator">=</span><span class="token string">&quot;Geometry&quot;</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这种标签和摄像机及 GPU 有着紧密的联系。</p><p>每次在场景中放置一个物体，我们都会将其信息发送给 GPU（如顶点位置、法线、颜色等）。 在<strong>游戏视图</strong>也是一样的，只是我们发送给 GPU 的信息对应于摄像机视锥体内的物体。 一旦信息进入 GPU，我们将这些数据发送给 VRAM，并让其在屏幕上绘制物体。</p><p>绘制物体的过程叫做“<strong>绘制调用</strong>”（Draw Call）。 着色器有越多的通道，在渲染时的绘制调用就越多。 一个通道就相当于一次绘制调用，因此，如果我们有一个两通道的着色器，那这个材质只会在 GPU 上产生两次<em>绘制调用</em>。</p><p>那么，GPU是如何将这些物体绘制到屏幕上的呢？ 简单来说，GPU 会先绘制离摄像机最远的物体，而最近的元素会在最后绘制。 此计算将依据物体与摄像机在其 Z 轴上距离。</p><figure><img src="/unityshaderbible/61-0.png" alt="图 3.5.1.1a 如图所示，由于方形离摄像机最远，因此会最先绘制在屏幕上。最后绘制三角形，一共产生 2 次绘制调用" tabindex="0" loading="lazy"><figcaption>图 3.5.1.1a 如图所示，由于方形离摄像机最远，因此会最先绘制在屏幕上。最后绘制三角形，一共产生 2 次绘制调用</figcaption></figure><p>Unity 有一个称为“<strong>渲染队列</strong>”（Render Queue）的处理队列，他让我们可以修改物体在 GPU 上的处理顺序。 有两种方法可以修改渲染队列：</p><ol><li>通过 Inspector 中的材质属性。</li><li>或使用 <code>Queue</code> 标签。</li></ol><p>如果我们在着色器中修改 <code>Queue</code> 的值，材质中<em>渲染队列</em>的默认值也会一并修改。</p><p>这个属性是一个顺序值，取值范围在 0 到 5000 之间，其中 0 表示最远的元素，而5000表示离摄像机最近的元素。 这些顺序值有预定义的组，它们是：</p><ul><li><strong>Background</strong></li><li><strong>Geometry</strong></li><li><strong>AlphaTest</strong></li><li><strong>Transparent</strong></li><li><strong>Overlay</strong></li></ul><p><code>Tags { &quot;Queue&quot;=&quot;Background&quot; }</code> 取值 0~1499，默认为 1000；<br><code>Tags { &quot;Queue&quot;=&quot;Geometry&quot; }</code> 取值 1500~2399，默认为 2000；<br><code>Tags { &quot;Queue&quot;=&quot;AlphaTest&quot; }</code> 取值 2400~2699，默认为 2450；<br><code>Tags { &quot;Queue&quot;=&quot;Transparent&quot; }</code> 取值 2700~3599，默认为 3000；<br><code>Tags { &quot;Queue&quot;=&quot;Overlay&quot; }</code> 取值 3600~5000，默认为 4000；</p><p><strong>Background</strong> 主要用于那些离摄像机非常远的元素，如天空盒；</p><p><strong>Geometry</strong> 是队列中的默认值，用于场景中的不透明物体（如基本体和常规物体）。</p><p><strong>AlphaTest</strong> 用于必须先是在不透明物体前，但要显示在透明物体之后的半透明物体（如玻璃、草、植被）。</p><p><strong>Transparent</strong> 用于必须显示在其他元素前面的透明元素。</p><p>最后，<strong>Overlay</strong>对应那些在场景中显示在最前面的元素（如 UI、图片）。</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code>Shader <span class="token string">&quot;InspectorPath/shaderName&quot;</span>
<span class="token punctuation">{</span>
  Properties <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
  SubShader
  <span class="token punctuation">{</span>
    Tags <span class="token punctuation">{</span> <span class="token string">&quot;Queue&quot;</span><span class="token operator">=</span><span class="token string">&quot;Geometry&quot;</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>HDRP 和内置 RP 使用渲染队列的方式有所不同，因为材质不会直接在 Inspector 中展示这个属性，而是引入了 2 种控制方式，它们是：</p><ul><li>材质顺序</li><li>渲染顺序</li></ul><p>HDRP 使用这两种排序方法来控制物体的处理。</p><h4 id="_3-5-1-2-rendertype-标签" tabindex="-1"><a class="header-anchor" href="#_3-5-1-2-rendertype-标签" aria-hidden="true">#</a> 3.5.1.2 RenderType 标签</h4><p>根据 Unity 官方文档，</p><blockquote><p>使用 <code>RenderType</code> 标签可覆盖 Shader 对象的行为。<sup class="footnote-ref"><a href="#footnote1">[1]</a><a class="footnote-anchor" id="footnote-ref1"></a></sup></p></blockquote><p>上面的说法是什么意思？ 基本上，使用这些标记，我们可以在子着色器中改变状态，在与给定类型匹配的任何材质上添加效果。</p><p>为了实现其功能，我们需要至少两个着色器：</p><ol><li>一个替换的（我们想要在运行时添加的颜色或效果）</li><li>一个要被替换的（指定给材质的着色器）</li></ol><p>其语法如下：</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code>Tags <span class="token punctuation">{</span> <span class="token string">&quot;RenderType&quot;</span><span class="token operator">=</span><span class="token string">&quot;type&quot;</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>和 Queue 标签一样，RenderType 也有不同的可配置值，这些值取决于我们想执行的任务。 其中有：</p><ul><li><strong>Opaque</strong>（默认）</li><li><strong>Transparent</strong></li><li><strong>TransparentCutout</strong></li><li><strong>Background</strong></li><li><strong>Overlay</strong></li><li><strong>TreeOpaque</strong></li><li><strong>TreeTransparentCutout</strong></li><li><strong>TreeBillboard</strong></li><li><strong>Grass</strong></li><li><strong>GrassBillboard</strong></li></ul><p>每次我们创建新着色器时，都会默认设置为 <code>Opaque</code> 。 同样，大多数 Unity 中的内置着色器都被设为了这个值，因为它们没有透明度的配置。 然而，我们可以自由地改变这个属性，一切都取决于我们想要应用的效果。</p><p>要彻底理解这个概念，我们要做以下的事。 在我们的工程中，</p><ol><li>我们要确保在场景中创建一些 3D 物体。</li><li>我们要创建一个 C# 脚本，名为 <code>USBReplacementController</code>。</li><li>之后我们要创建一个着色器，名为 <code>USB_replacement_shader</code>。</li><li>最后，我们要添加一个材质，名为 <code>USB_replaced_mat</code>。</li></ol><p>我们要使用 <code>Camera.SetReplacementShader</code> 来为材质 <code>USB_replaced_mat</code> 动态指定着色器。 要实现这个功能，材质着色器必须有一个 <code>RenderType</code> 标签和替换着色器相同。</p><p>为了演示，我么为 <code>USB_replaced_mat</code> 指定 <code>Mobile/Unlit</code>。 这个内置着色器配置 <code>RenderType</code> 为 <code>Opaque</code>。 因此，着色器 <code>USB_replacement_shader</code> 必须匹配相同的 <code>RenderType</code> 才能执行操作。</p><figure><img src="/unityshaderbible/65-0.png" alt="图 3.5.1.2a 将 Unlit 着色器（支持光照贴图）指定给  材质" tabindex="0" loading="lazy"><figcaption>图 3.5.1.2a 将 Unlit 着色器（支持光照贴图）指定给 <code>USB_replaced_mat</code> 材质</figcaption></figure><p><code>USBReplacementController</code> 脚本必须直接作为组件挂载到摄像机。 这个控制器负责替换着色器，只要他们的 <code>RenderType</code> 配置相同即可。</p><div class="language-csharp line-numbers-mode" data-ext="cs"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collection</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Collection<span class="token punctuation">.</span>Generic</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">UnityEngine</span><span class="token punctuation">;</span>

<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">ExecuteInEditMode</span></span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">USBReplacementController</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">MonoBehaviour</span></span>
<span class="token punctuation">{</span>
    <span class="token comment">// replacement shader</span>
    <span class="token keyword">public</span> <span class="token class-name">Shader</span> m_replacementShader<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnEnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>m_replacementShader <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// the camera will replace all the shaders in the scene with the replacement one the &quot;RenderType&quot; configuration must match in both shader</span>
            <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Camera<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetReplacementShader</span><span class="token punctuation">(</span>
                m_replacementShader<span class="token punctuation">,</span> <span class="token string">&quot;RenderType&quot;</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnDisable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// let&#39;s reset the default shader</span>
        <span class="token generic-method"><span class="token function">GetComponent</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Camera<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ResetReplacementShader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>值得一提的是，我们在类上方定义了 <code>[ExecuteInEditMode]</code> 功能。 这个属性让我们可以在编辑模式预览变化。</p><p>我们使用 <strong>USB_replacement_shader</strong> 作为替换着色器。</p><p>正如我们所知，每次我们创建一个新的着色器，它都会配置其 <code>RenderType</code> 为 <code>Opaque</code>。 因此，<strong>USB_replacement_shader</strong> 可以替换掉我们先前指定给材质的 Unlit 着色器。</p><p>为了让变化清晰可见，我们将在 <strong>USB_replacement_shader</strong> 的片元着色器阶段添加红色，乘上输出颜色。</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code>fixed4 <span class="token function">frag</span> <span class="token punctuation">(</span>v2f i<span class="token punctuation">)</span> <span class="token operator">:</span> SV_Target
<span class="token punctuation">{</span>
  fixed4 col <span class="token operator">=</span> <span class="token function">tex2D</span><span class="token punctuation">(</span>_MainTex<span class="token punctuation">,</span> i<span class="token punctuation">.</span>uv<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// add a red color 添加红色</span>
  fixed4 red <span class="token operator">=</span> <span class="token function">fixed4</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> col <span class="token operator">*</span> red<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们要确保在 <strong>USBReplacementController</strong> 脚本的着色器类型的替换变量中引用 <strong>USB_replacement_shader</strong> 。</p><figure><img src="/unityshaderbible/67-0.png" alt="图 3.5.1.2b USBReplacementController 已指定给摄像机" tabindex="0" loading="lazy"><figcaption>图 3.5.1.2b USBReplacementController 已指定给摄像机</figcaption></figure><p>此外，那些我们之前添加到场景中的物体必须有材质 <strong>USB_replaced_mat</strong>。</p><figure><img src="/unityshaderbible/67-1.png" alt="图 3.5.1.2c 材质 USB_replaced_mat 已指定到 3D 物体上，包括一个平面、一个盒体和一个球体" tabindex="0" loading="lazy"><figcaption>图 3.5.1.2c 材质 USB_replaced_mat 已指定到 3D 物体上，包括一个平面、一个盒体和一个球体</figcaption></figure><p>因为 <code>USBReplacementController</code> 类已包含 <code>OnEnable</code> 和 <code>OnDisable</code> 函数，如果我们激活或停用脚本，我们就能看见内置着色器 Unlit 是如何在编辑模式替换为 USB_replacement_shader 的，在渲染时应用了红颜色。</p><figure><img src="/unityshaderbible/68-0.png" alt="图 3.5.1.2d USB_replacement_shader 在最终渲染中替换了内置着色器 Unlit" tabindex="0" loading="lazy"><figcaption>图 3.5.1.2d USB_replacement_shader 在最终渲染中替换了内置着色器 Unlit</figcaption></figure><h3 id="_3-5-2-子着色器混合" tabindex="-1"><a class="header-anchor" href="#_3-5-2-子着色器混合" aria-hidden="true">#</a> 3.5.2 子着色器混合</h3><p>混合是将两个像素混合成一个的过程。 其指令在内置 RP 和可编程 RP 都是兼容的。</p><p><em>混合</em>发生在名为“<strong>合并</strong>”（merging）的阶段，它将像素（指在片元着色器阶段处理过的像素）的最终颜色和它的深度结合。 这个阶段，发生在渲染管线的最后，在<strong>片元着色器阶段</strong>之后，也是执行模板缓冲、z 缓冲和颜色混合的阶段。</p><p>默认情况下，这个属性不会写在着色器中，因为这是一个可选功能，且主要用于我们处理透明物体时，例如，例如我们要在一个物体前绘制一个不透明度较低的像素时。</p><div class="hint-container tip"><p class="hint-container-title">Alpha vs. Tranparency vs. Opacity</p><p>这三个是什么？好像经常会在见到用这些词来描述透明的物体，有什么区别呢？</p><ul><li>Transparency：透明度，简单来说，透明度越高，物体越透明。</li><li>Opacity：有些地方也把它翻译为“透明度”，但正确的翻译应该是“不透明度”，因为 “Low Opacity”意为物体透明。</li><li>Alpha：一般用在描述颜色时，RGBA 中的 A，表示<strong>不透明度</strong>。</li></ul></div><p>其默认值为“Blend Off”（关闭混合），但我们可以启动它来生成不同类型的<em>混合</em>，就像 PS 中的那样。</p><p>其语法如下：</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code>Blend <span class="token punctuation">[</span>SourceFactor<span class="token punctuation">]</span> <span class="token punctuation">[</span>SestinationFactor<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>Blend</code> 是一个需要两个值进行运算的函数，这两个值称为“因子”（factors），根据一个算式算出屏幕上的最终颜色。 根据 Unity 官方文档，这个定义了混合值的算式如下：</p><blockquote><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mi>S</mi><mi>r</mi><mi>c</mi><mi>F</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi><mo>∗</mo><mi>S</mi><mi>r</mi><mi>c</mi><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo stretchy="false">[</mo><mi>O</mi><mi>P</mi><mo stretchy="false">]</mo><mi>D</mi><mi>s</mi><mi>t</mi><mi>F</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi><mo>∗</mo><mi>D</mi><mi>s</mi><mi>t</mi><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">B = SrcFactor * SrcValue [OP] DstFactor * DstValue</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">rc</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">rc</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.13889em;">OP</span><span class="mclose">]</span><span class="mord mathnormal">Ds</span><span class="mord mathnormal" style="margin-right:0.13889em;">tF</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">Ds</span><span class="mord mathnormal">t</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span></span></span></span></p></blockquote><p>要理解这个运算，我们要考虑如下：先发生<strong>片元着色器阶段</strong>，然后才是作为可选过程的<strong>混合阶段</strong>。</p><p>“<strong>SrcValue</strong>”（source value）已在<strong>片元着色器阶段</strong>处理，对应像素的 RGB 颜色输出。</p><p>“<strong>DstValue</strong>”（destination value）对应已经写入到“目标缓冲”（destination buffer）中的 RGB 颜色，也被称为渲染目标（render target）<code>SV_Target</code>。 当着色器中的混合选项未激活时，SrcValue 会覆写 DstValue。 然而，如果我们激活这个运算，两种颜色会混合成一个新颜色，并覆写之前的 DstValue。</p><p>“<strong>SrcFator</strong>”（source factor）和“<strong>DstFactor</strong>”（destination factor）是可配置的三维向量。 它们的主要功能是修改 SrcValue 和 DstValue 的值以得到有趣的效果。</p><p>我们可以在 Unity 文档种找到的因子有：</p><ul><li><strong>Off</strong>，禁用混合选项。</li><li><strong>One</strong>，<code>(1, 1, 1)</code>。</li><li><strong>Zero</strong>，<code>(0, 0, 0)</code>。</li><li><strong>SrcColor</strong> 等于 <em>SrcValue</em> 的 RGB 值。</li><li><strong>SrcAlpha</strong> 等于 <em>SrcValue</em> 的 Alpha 值。</li><li><strong>OneMinusSrcColor</strong>，1 减 <em>SrcValue</em> 的 RGB 值<code>(1 - R, 1 - G, 1 - B)</code>。</li><li><strong>OneMinusSrcAlpha</strong>，1 减 <em>SrcValue</em> 的 Alpha 值<code>(1 - A, 1 - A, 1 - A)</code>。</li><li><strong>DstColor</strong> 等于 <em>DstValue</em> 的 RGB 值。</li><li><strong>DstAlpha</strong> 等于 <em>DstValue</em> 的 Alpha 值。</li><li><strong>OneMinusDstColor</strong>，1 减 <em>DstValue</em> 的 RGB 值<code>(1 - R, 1 - G, 1 - B)</code>。</li><li><strong>OneMinusDstAlpha</strong>，1 减 <em>DstValue</em> 的 Alpha 值<code>(1 - A, 1 - A, 1 - A)</code>。</li></ul><p>值得一提的是，Alpha 通道的混合和处理像素 RGB 颜色的方式相同，但因为它并不常用，因此是在单独的过程中处理。 同样，通过不执行这个过程，可以优化向渲染目标的写入。</p><p>让我们用如下的例子解释上述问题。</p><p>假设我们有一个 RGB 颜色像素，其值为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0.</mn><msub><mn>5</mn><mi>R</mi></msub><mo separator="true">,</mo><mn>0.4</mn><msub><mn>5</mn><mi>G</mi></msub><mo separator="true">,</mo><mn>0.3</mn><msub><mn>5</mn><mi>B</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0.5_R, 0.45_G, 0.35_B]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0.</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.4</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.3</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>。 这个颜色经过<strong>片元着色器阶段</strong>处理，因此对应 <em>DstValue</em>。 现在，我们用“<em>SrcFactor</em> <strong>One</strong>”（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[1, 1, 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>）乘上这个值。</p><blockquote><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mo stretchy="false">[</mo><mn>0.</mn><msub><mn>5</mn><mi>R</mi></msub><mo separator="true">,</mo><mn>0.4</mn><msub><mn>5</mn><mi>G</mi></msub><mo separator="true">,</mo><mn>0.3</mn><msub><mn>5</mn><mi>B</mi></msub><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mi>O</mi><mi>P</mi><mo stretchy="false">]</mo><mi>D</mi><mi>s</mi><mi>t</mi><mi>F</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi><mo>∗</mo><mi>D</mi><mi>s</mi><mi>t</mi><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">B = [0.5_R, 0.45_G, 0.35_B][OP] DstFactor * DstValue</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0.</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.4</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.3</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.13889em;">OP</span><span class="mclose">]</span><span class="mord mathnormal">Ds</span><span class="mord mathnormal" style="margin-right:0.13889em;">tF</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">Ds</span><span class="mord mathnormal">t</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span></span></span></span></p></blockquote><p>“OP” 表示我们要执行的运算。默认情况下为“叠加”（Add）。</p><blockquote><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mo stretchy="false">[</mo><mn>0.</mn><msub><mn>5</mn><mi>R</mi></msub><mo separator="true">,</mo><mn>0.4</mn><msub><mn>5</mn><mi>G</mi></msub><mo separator="true">,</mo><mn>0.3</mn><msub><mn>5</mn><mi>B</mi></msub><mo stretchy="false">]</mo><mo>+</mo><mi>D</mi><mi>s</mi><mi>t</mi><mi>F</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi><mo>∗</mo><mi>D</mi><mi>s</mi><mi>t</mi><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">B = [0.5_R, 0.45_G, 0.35_B]+ DstFactor * DstValue</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0.</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.4</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.3</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">Ds</span><span class="mord mathnormal" style="margin-right:0.13889em;">tF</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">Ds</span><span class="mord mathnormal">t</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span></span></span></span></p></blockquote><p>一旦我们取得了第一个运算的值，它就会被 <em>DstValue</em> 覆写，因此，其值同样为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0.</mn><msub><mn>5</mn><mi>R</mi></msub><mo separator="true">,</mo><mn>0.4</mn><msub><mn>5</mn><mi>G</mi></msub><mo separator="true">,</mo><mn>0.3</mn><msub><mn>5</mn><mi>B</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0.5_R, 0.45_G, 0.35_B]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0.</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.4</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.3</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>。 因此我们用“<em>DstFactor</em> <strong>DstColor</strong>”，其值等于当前的 <em>DstValue</em> 值。</p><blockquote><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>s</mi><mi>t</mi><mi>F</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi><mo stretchy="false">[</mo><mn>0.</mn><msub><mn>5</mn><mi>R</mi></msub><mo separator="true">,</mo><mn>0.4</mn><msub><mn>5</mn><mi>G</mi></msub><mo separator="true">,</mo><mn>0.3</mn><msub><mn>5</mn><mi>B</mi></msub><mo stretchy="false">]</mo><mo>∗</mo><mi>D</mi><mi>s</mi><mi>t</mi><mi>V</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo stretchy="false">[</mo><mn>0.</mn><msub><mn>5</mn><mi>R</mi></msub><mo separator="true">,</mo><mn>0.4</mn><msub><mn>5</mn><mi>G</mi></msub><mo separator="true">,</mo><mn>0.3</mn><msub><mn>5</mn><mi>B</mi></msub><mo stretchy="false">]</mo><mo>=</mo><mo stretchy="false">[</mo><mn>0.2</mn><msub><mn>5</mn><mi>R</mi></msub><mo separator="true">,</mo><mn>0.2</mn><msub><mn>0</mn><mi>G</mi></msub><mo separator="true">,</mo><mn>0.1</mn><msub><mn>2</mn><mi>B</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">DstFactor [0.5_R, 0.45_G, 0.35_B] * DstValue [0.5_R, 0.45_G, 0.35_B] = [0.25_R, 0.20_G, 0.12_B]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Ds</span><span class="mord mathnormal" style="margin-right:0.13889em;">tF</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mopen">[</span><span class="mord">0.</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.4</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.3</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Ds</span><span class="mord mathnormal">t</span><span class="mord mathnormal">Va</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mopen">[</span><span class="mord">0.</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.4</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.3</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0.2</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.2</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.1</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></p></blockquote><p>最后，像素的输出颜色为：</p><blockquote><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mo stretchy="false">[</mo><mn>0.</mn><msub><mn>5</mn><mi>R</mi></msub><mo separator="true">,</mo><mn>0.4</mn><msub><mn>5</mn><mi>G</mi></msub><mo separator="true">,</mo><mn>0.3</mn><msub><mn>5</mn><mi>B</mi></msub><mo stretchy="false">]</mo><mo>+</mo><mo stretchy="false">[</mo><mn>0.2</mn><msub><mn>5</mn><mi>R</mi></msub><mo separator="true">,</mo><mn>0.2</mn><msub><mn>0</mn><mi>G</mi></msub><mo separator="true">,</mo><mn>0.1</mn><msub><mn>2</mn><mi>B</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">B = [0.5_R, 0.45_G, 0.35_B] + [0.25_R, 0.20_G, 0.12_B]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0.</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.4</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.3</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0.2</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.2</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.1</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mo stretchy="false">[</mo><mn>0.7</mn><msub><mn>5</mn><mi>R</mi></msub><mo separator="true">,</mo><mn>0.6</mn><msub><mn>5</mn><mi>G</mi></msub><mo separator="true">,</mo><mn>0.4</mn><msub><mn>7</mn><mi>B</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">B = [0.75_R, 0.65_G, 0.47_B]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0.7</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.6</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.4</span><span class="mord"><span class="mord">7</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></p></blockquote><p>如果我们想在我们的着色器种启用<em>混合</em>，我们必须使用 <code>Blend</code> 命令，后接 <code>SrcFactor</code> 和 <code>DstFactor</code>。</p><p>其语法如下：</p><div class="language-hlsl line-numbers-mode" data-ext="hlsl"><pre class="language-hlsl"><code>Shader <span class="token string">&quot;InspectorPath/shaderName&quot;</span>
<span class="token punctuation">{</span>
  Properties <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
  SubShader
  <span class="token punctuation">{</span>
    Tag <span class="token punctuation">{</span> <span class="token string">&quot;Queue&quot;</span><span class="token operator">=</span><span class="token string">&quot;Transparent&quot;</span> <span class="token string">&quot;RenderType&quot;</span><span class="token operator">=</span><span class="token string">&quot;Transparent&quot;</span> <span class="token punctuation">}</span>
    Blend SrcAlpha OneMinusSrcAlpha
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果想在我们的着色器中使用<em>混合</em>，需要添加并修改 <code>Render Queue</code>。 我们知道 <code>Queue</code> 标签的默认值为 <code>Geometry</code>，意为我们的物体是不透明的。如果想让我们的物体半透明，那我们必须先将 <code>Queue</code> 改为 <code>Transparent</code>，并添加某种混合。</p><h3 id="_3-5-3-子着色器-alphatomask" tabindex="-1"><a class="header-anchor" href="#_3-5-3-子着色器-alphatomask" aria-hidden="true">#</a> 3.5.3 子着色器 AlphaToMask</h3><h3 id="_3-5-4-子着色器-colormask" tabindex="-1"><a class="header-anchor" href="#_3-5-4-子着色器-colormask" aria-hidden="true">#</a> 3.5.4 子着色器 ColorMask</h3><h3 id="_3-5-5-子着色器-culling-和深度测试" tabindex="-1"><a class="header-anchor" href="#_3-5-5-子着色器-culling-和深度测试" aria-hidden="true">#</a> 3.5.5 子着色器 Culling 和深度测试</h3><h3 id="_3-5-6-子着色器-cull" tabindex="-1"><a class="header-anchor" href="#_3-5-6-子着色器-cull" aria-hidden="true">#</a> 3.5.6 子着色器 Cull</h3><h3 id="_3-5-7-子着色器-zwrite" tabindex="-1"><a class="header-anchor" href="#_3-5-7-子着色器-zwrite" aria-hidden="true">#</a> 3.5.7 子着色器 ZWrite</h3><h3 id="_3-5-8-子着色器-ztest" tabindex="-1"><a class="header-anchor" href="#_3-5-8-子着色器-ztest" aria-hidden="true">#</a> 3.5.8 子着色器 ZTest</h3><h3 id="_3-5-9-子着色器-stencil" tabindex="-1"><a class="header-anchor" href="#_3-5-9-子着色器-stencil" aria-hidden="true">#</a> 3.5.9 子着色器 Stencil</h3><h2 id="_3-6-子着色器通道" tabindex="-1"><a class="header-anchor" href="#_3-6-子着色器通道" aria-hidden="true">#</a> 3.6 子着色器通道</h2><h3 id="_3-6-1-cgprogram-endcg" tabindex="-1"><a class="header-anchor" href="#_3-6-1-cgprogram-endcg" aria-hidden="true">#</a> 3.6.1 CGPROGRAM / ENDCG</h3><h3 id="_3-6-2-数据类型" tabindex="-1"><a class="header-anchor" href="#_3-6-2-数据类型" aria-hidden="true">#</a> 3.6.2 数据类型</h3><h3 id="_3-6-3-cg-hlsl-pragmas" tabindex="-1"><a class="header-anchor" href="#_3-6-3-cg-hlsl-pragmas" aria-hidden="true">#</a> 3.6.3 Cg / HLSL Pragmas</h3><h3 id="_3-6-4-cg-hlsl-include" tabindex="-1"><a class="header-anchor" href="#_3-6-4-cg-hlsl-include" aria-hidden="true">#</a> 3.6.4 Cg / HLSL Include</h3><h3 id="_3-6-5-cg-hlsl-顶点输入与顶点输出" tabindex="-1"><a class="header-anchor" href="#_3-6-5-cg-hlsl-顶点输入与顶点输出" aria-hidden="true">#</a> 3.6.5 Cg / HLSL 顶点输入与顶点输出</h3><h3 id="_3-6-6-cg-hlsl-变量和关联向量" tabindex="-1"><a class="header-anchor" href="#_3-6-6-cg-hlsl-变量和关联向量" aria-hidden="true">#</a> 3.6.6 Cg / HLSL 变量和关联向量</h3><h3 id="_3-6-7-cg-hlsl-顶点着色器阶段" tabindex="-1"><a class="header-anchor" href="#_3-6-7-cg-hlsl-顶点着色器阶段" aria-hidden="true">#</a> 3.6.7 Cg / HLSL 顶点着色器阶段</h3><h3 id="_3-6-8-cg-hlsl-片元着色器阶段" tabindex="-1"><a class="header-anchor" href="#_3-6-8-cg-hlsl-片元着色器阶段" aria-hidden="true">#</a> 3.6.8 Cg / HLSL 片元着色器阶段</h3><h2 id="_3-7-子着色器回退" tabindex="-1"><a class="header-anchor" href="#_3-7-子着色器回退" aria-hidden="true">#</a> 3.7 子着色器回退</h2><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="footnote1" class="footnote-item"><p><a href="https://docs.unity.cn/cn/current/Manual/SL-SubShaderTags.html" target="_blank" rel="noopener noreferrer">ShaderLab 向子着色器分配标签 - Unity 手册<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> <a href="#footnote-ref1" class="footnote-backref">↩︎</a></p></li></ol></section></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/vuepress-theme-hope/vuepress-theme-hope/edit/main/docs/game_dev/TA/the_unity_shader_bible/introduction_to_the_shader_programming_language/properties_commands_and_functions.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在 GitHub 上编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">上次编辑于: </span><!----></div><div class="contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: SaltSakya@Yahoo.com">SaltSakya</span><!--]--><!--]--></div></div></footer><!----><div class="giscus-wrapper input-top" id="comment" style="display:block;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">变得更好，变得更强！</div><div class="copyright">Copyright © 2023 舒服嘉</div></footer></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app-2685e7e5.js" defer></script>
  </body>
</html>
